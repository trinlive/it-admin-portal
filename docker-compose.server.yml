version: '3.8'

services:
  it-admin-portal-app:
    # ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ Portainer Build Image ‡∏à‡∏≤‡∏Å Source Code ‡πÉ‡∏ô GitHub
    build: .
    
    image: it-admin-portal:latest
    container_name: it-admin-portal
    restart: always
    environment:
      - NODE_ENV=production
      - PORT=3001
      
      # üëá Database Config (‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Portainer Env)
      - DB_HOST=it-log-db
      - DB_DIALECT=mysql
      - DB_NAME=${DB_NAME}
      - DB_USER=${DB_USER}
      - DB_PASS=${DB_PASS}
      
      # üëá AD Config (‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Portainer Env)
      - AD_URL=ldap://samba-ad
      - AD_BASE_DN=${AD_BASE_DN}
      - AD_USER=${AD_USER}
      - AD_PASS=${AD_PASS}
      
      # üëá Google OAuth (‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Portainer Env)
      - GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
      - GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
      - GOOGLE_CALLBACK_URL=${GOOGLE_CALLBACK_URL}
      - ALLOWED_EMAILS=${ALLOWED_EMAILS}
      - SESSION_SECRET=${SESSION_SECRET}

    networks:
      - app-network
      - cf-network

networks:
  app-network:
    external: true
    # üëá ‡∏ä‡∏∑‡πà‡∏≠ Network ‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà samba-ad ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà (‡πÄ‡∏ä‡πá‡∏Ñ‡∏à‡∏≤‡∏Å docker network ls)
    name: app-network  
  
  cf-network:
    external: true
    # üëá ‡∏ä‡∏∑‡πà‡∏≠ Network ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Cloudflare Tunnel
    name: cf-network