version: '3.8'

services:
  it-admin-portal-app:
    build: .             # üëà ‡πÉ‡∏´‡πâ Portainer ‡∏ä‡πà‡∏ß‡∏¢ Build ‡∏à‡∏≤‡∏Å Source Code ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢
    container_name: it-admin-portal
    restart: always
    environment:
      - NODE_ENV=production
      - PORT=3001
      
      # üëá ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏≤ Stack it-infra (‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ Container ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)
      - DB_HOST=it-log-db
      - AD_URL=ldap://samba-ad
      - AD_BASE_DN=DC=ad,DC=biccorp,DC=com
      
      # üëá ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡πÑ‡∏õ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Portainer (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏ß‡πà‡∏≤)
      - AD_USER=Administrator@ad.biccorp.com
      - AD_PASS=${AD_PASS}
      - DB_USER=it_admin
      - DB_PASS=${DB_PASS}
      
      # üëá ‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô Domain ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Dev
      - GOOGLE_CALLBACK_URL=https://it-portal.biccorp.com/auth/google/callback

    networks:
      - app-network      # ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ñ‡∏ô‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô (‡πÄ‡∏à‡∏≠ DB/AD)
      - cf-network       # ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ñ‡∏ô‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô (‡πÄ‡∏à‡∏≠ Tunnel)

networks:
  app-network:
    external: true
  cf-network:
    external: true